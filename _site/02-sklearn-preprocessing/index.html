















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2022-02-10 18:19:54 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>


    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Introduction to Machine Learning using Python"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Introduction to Scikit Learn &ndash; Introduction to Machine Learning using Python
  </title>

  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body beta">
    This lesson is being piloted (Beta version)
  </div>
</div>




    <div class="container">
      
















  
  










<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      <a href="https://www.palmetto.clemson.edu" class="pull-left">
        <img class="navbar-logo" src="../assets/img/clemson.png" alt="West Chester University logo" />
      </a>

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li><a href="../01-introduction/index.html">Introduction to Machine Learning</a></li>
            
            
            <li><a href="../02-sklearn-preprocessing/index.html">Introduction to Scikit Learn</a></li>
            
            
            <li><a href="../03-sklearn-Data-Partition/index.html">Data Partition with Scikit-Learn</a></li>
            
            
            <li><a href="../04.sklearn-Evaluation-Metrics/index.html">Evaluation Metrics with Scikit-Learn</a></li>
            
            
            <li><a href="../05-Training_Regression/index.html">Training Machine Learning model using Regression Method</a></li>
            
            
            <li><a href="../06-Training_Tree/index.html">Training Machine Learning model using Tree-based model</a></li>
            
            
            <li><a href="../07-Training_Ensemble/index.html">Training Machine Learning model using Ensemble approach</a></li>
            
            
            <li><a href="../08-Model_Based/index.html">Training Machine Learning model using Model based Prediction</a></li>
            
            
            <li><a href="../09-Regularization/index.html">Regularization and Variable Selection</a></li>
            
            
            <li><a href="../10-Dimension-Reduction/index.html">Dimension Reduction</a></li>
            
            
            <li><a href="../11-Neural-Network/index.html">Neural Network</a></li>
            
            
            <li><a href="../12-Support%20Vector%20Machine/index.html">Support Vector Machine</a></li>
            
            
            <li><a href="../13-KNN/index.html">K-Nearest Neighbour</a></li>
            
            
            <li><a href="../14-Unsupervised-Learning/index.html">Unsupervised Learning</a></li>
            
            
            <li><a href="../15-Mini-Project/index.html">Mini-Project</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            
            <li><a href="../Addon_DecisionTree/index.html">Detailed explanation on Decision Tree</a></li>
            
            
            <li><a href="../about/index.html">About</a></li>
            
            
            <li><a href="../figures/index.html">Figures</a></li>
            
            
            <li><a href="../guide/index.html">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>




























  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../01-introduction/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Introduction to Machine Learning using Python</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../03-sklearn-Data-Partition/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Introduction to Scikit Learn</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>












<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 40 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is Scikit Learn</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Master Scikit Learn for Machine Learning</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="21-what-is-scikit-learn">2.1 What is Scikit-Learn</h2>
<p><img src="https://user-images.githubusercontent.com/43855029/114609814-30db9f80-9c6d-11eb-8d4e-781f578e1d79.png" alt="image" /></p>

<ul>
  <li>Scikit-learn is probably the most useful library for machine learning in Python.</li>
  <li>The sklearn library contains a lot of efficient tools for machine learning and statistical modeling including classification, regression, clustering and dimensionality reduction.</li>
  <li>The sklearn package contains tools for:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  - data splitting
  - pre-processing
  - feature selection
  - model tuning using resampling
  - variable importance estimation
  as well as other functionality.
  
</code></pre></div></div>
<h2 id="22-install-sklearn">2.2 Install <code class="language-plaintext highlighter-rouge">sklearn</code></h2>
<p>We have installed the conda environment <code class="language-plaintext highlighter-rouge">skln</code> and include the scikit-learn package on Palmetto.</p>

<h2 id="23-pre-processing-using-sklearn">2.3 Pre-processing using <code class="language-plaintext highlighter-rouge">sklearn</code></h2>
<p>There are several steps that we will use <code class="language-plaintext highlighter-rouge">sklearn</code> for. For preprocessing raw data, we gonna use <code class="language-plaintext highlighter-rouge">sklearn</code> in these tasks:</p>
<ul>
  <li>Preprocessing with missing value</li>
  <li>Preprocessing: transform data</li>
</ul>

<h3 id="231-pre-processing-with-missing-value">2.3.1 Pre-processing with missing value</h3>
<ul>
  <li>Most of the time the input data has missing values (<code class="language-plaintext highlighter-rouge">NA, NaN, Inf</code>) due to data collection issue (power, sensor, personel).</li>
  <li>There are three main problems that missing data causes: missing data can introduce a substantial amount of bias, make the handling and analysis of the data more arduous, and create reductions in efficiency</li>
  <li>These missing values need to be treated/cleaned before we can use because “Garbage in =&gt; Garbage out”.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'/zfs/citi/workshop_data/python_ml/r_airquality.csv'</span><span class="p">))</span>
<span class="n">data_df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../fig/02-preprocessing/01.png" style="height:300px" /></p>

<ul>
  <li>There are several ways to treat the missing values:</li>
  <li>Method 1: remove all missing <code class="language-plaintext highlighter-rouge">NA</code> values</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data1</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">data1</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../fig/02-preprocessing/02.png" style="height:300px" /></p>

<ul>
  <li>Method 2: Set <code class="language-plaintext highlighter-rouge">NA</code> to mean value</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data2</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">data2</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">data2</span><span class="p">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="../fig/02-preprocessing/03.png" style="height:300px" /></p>

<ul>
  <li>Method 3: Use <code class="language-plaintext highlighter-rouge">Impute</code> to handle missing values</li>
</ul>

<p>In statistics, imputation is the process of replacing missing data with substituted values. 
Because missing data can create problems for analyzing data, imputation is seen as a way to 
avoid pitfalls involved with listwise deletion of cases that have missing values. That is to 
say, when one or more values are missing for a case, most statistical packages default to discarding 
any case that has a missing value, which may introduce bias or affect the representativeness of the 
results. Imputation preserves all cases by replacing missing data with an estimated value based on 
other available information. Once all missing values have been imputed, the data set can then be 
analysed using standard techniques for complete data. There have been many theories embraced by 
scientists to account for missing data but the majority of them introduce bias. A few of the well 
known attempts to deal with missing data include:</p>
<ul>
  <li>hot deck and cold deck imputation;</li>
  <li>listwise and pairwise deletion;</li>
  <li>mean imputation;</li>
  <li>non-negative matrix factorization;</li>
  <li>regression imputation;</li>
  <li>last observation carried forward;</li>
  <li>stochastic imputation;</li>
  <li>and multiple imputation.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s">'mean'</span><span class="p">)</span>
<span class="n">data3</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_df</span><span class="p">))</span>
<span class="n">data3</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">.</span><span class="n">columns</span>
<span class="n">data3</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../fig/02-preprocessing/04.png" style="height:320px" /></p>

<p><strong>Note:</strong>
SimpleImputer converts missing values to <strong>mean, median, most_frequent and constant</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">missing_values</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">strategy</span><span class="o">=</span><span class="s">'median'</span><span class="p">)</span>
<span class="n">data4</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_df</span><span class="p">))</span>
<span class="n">data4</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data_df</span><span class="p">.</span><span class="n">columns</span>
<span class="n">data4</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../fig/02-preprocessing/05.png" style="height:320px" /></p>

<p><code class="language-plaintext highlighter-rouge">knnImpute</code> can also be used to fill in missing value</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">KNNImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">KNNImputer</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s">"uniform"</span><span class="p">)</span>
<span class="n">data_knnimpute</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">imputer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data_df</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="../fig/02-preprocessing/06.png" style="height:300px" /></p>

<p><strong>Note:</strong></p>
<ul>
  <li>In addition to KNNImputer, there are <strong>IterativeImputer</strong> (Multivariate imputer that estimates each feature from all the others) and <strong>MissingIndicator</strong>(Binary indicators for missing values)</li>
  <li>More information on sklearn.impute can be found <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.impute">here</a></li>
</ul>

<h3 id="232-pre-processing-with-transforming-data">2.3.2 Pre-processing with Transforming data</h3>
<h4 id="2321-using-standardization">2.3.2.1 Using Standardization</h4>
<p><img src="https://user-images.githubusercontent.com/43855029/114231774-df6ba180-9948-11eb-9c61-3d2e0d3df889.png" alt="image" /></p>

<ul>
  <li>Standardization comes into picture when features of input data set have large differences between their ranges, or simply when they are measured in different measurement units for example: rainfall (0-1000mm), temperature (-10 to 40oC), humidity (0-100%), etc.</li>
  <li>Standardition Convert all independent variables into the same scale (mean=0, std=1)</li>
  <li>These differences in the ranges of initial features causes trouble to many machine learning models. For example, for the models that are based on distance computation, if one of the features has a broad range of values, the distance will be governed by this particular feature.</li>
  <li>The example below use data from above:
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">scale</span>
<span class="n">data_std</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">with_mean</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">with_std</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">data_std</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data3</span><span class="p">.</span><span class="n">columns</span>
<span class="n">data_std</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># axis used to compute the means and standard deviations along. If 0, independently standardize each feature, otherwise (if 1) standardize each sample.
</span></code></pre></div>    </div>
  </li>
</ul>

<p><img src="../fig/02-preprocessing/07.png" style="height:300px" /></p>

<h4 id="2322-using-scaling-with-predefine-range">2.3.2.2 Using scaling with predefine range</h4>
<p>Transform features by scaling each feature to a given range.
This estimator scales and translates each feature individually such that it is in the given range on the training set, e.g. between zero and one.
Formulation for this is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>X_std = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0))
X_scaled = X_std * (max - min) + min
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="c1">#By default, it scales for (0, 1) range
</span><span class="n">data_scaler</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data3</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="../fig/02-preprocessing/08.png" style="height:300px" /></p>

<h4 id="2323-using-box-cox-transformation">2.3.2.3 Using Box-Cox Transformation</h4>
<ul>
  <li>A <a href="https://rss.onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1964.tb00553.x">Box Cox</a> transformation is a transformation of a non-normal dependent variables into a normal shape.</li>
  <li>Normality is an important assumption for many statistical techniques; if your data isn’t normal, applying a Box-Cox means that you are able to run a broader number of tests.</li>
  <li>The Box Cox transformation is named after statisticians George Box and Sir David Roxbee Cox who collaborated on a 1964 paper and developed the technique.</li>
  <li>BoxCox can only be applied to stricly positive values
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">power_transform</span>
<span class="n">data_BxCx</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">power_transform</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">"box-cox"</span><span class="p">))</span>
<span class="n">data_BxCx</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data3</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div>    </div>
  </li>
</ul>

<p><img src="../fig/02-preprocessing/09.png" style="height:300px" /></p>

<h4 id="2324-using-yeo-johnson-transformation">2.3.2.4 Using Yeo Johnson Transformation</h4>
<p>While BoxCox only works with positive value, a more recent transformation method <a href="https://www.jstor.org/stable/2673623">Yeo Johnson</a> can transform both positive and negative values.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_yeo_johnson</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">power_transform</span><span class="p">(</span><span class="n">data3</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">"yeo-johnson"</span><span class="p">))</span>
<span class="n">data_yeo_johnson</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">data3</span><span class="p">.</span><span class="n">columns</span>
<span class="n">data_yeo_johnson</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="../fig/02-preprocessing/10.png" style="height:300px" /></p>

<p>Graphical representation of different transformation techniques</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data3</span><span class="p">[</span><span class="s">"Ozone"</span><span class="p">])</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Original probability"</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Ozone'</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">232</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_BxCx</span><span class="p">[</span><span class="s">"Ozone"</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Box-Cox Transformation"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Ozone'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">233</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_yeo_johnson</span><span class="p">[</span><span class="s">"Ozone"</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Yeo-Johnson Transformation"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Ozone'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">234</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_std</span><span class="p">[</span><span class="s">"Ozone"</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Standard Transformation"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Ozone'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">235</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data_scaler</span><span class="p">[</span><span class="s">"Ozone"</span><span class="p">])</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"Scaling Transformation"</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Ozone'</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="../fig/02-preprocessing/11.png" style="height:600px" /></p>






<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>sklearn</p>
</li>
    
  </ul>
</blockquote>

</article>



























  
  











<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../01-introduction/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../03-sklearn-Data-Partition/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>



<!--  
      






<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
	
	Licensed under <a href="">CC-BY 4.0</a> 2018–2022
	by <a href="">The Carpentries</a>
        <br>
        Licensed under <a href="">CC-BY 4.0</a> 2016–2018
	by <a href="">Software Carpentry Foundation</a>
	
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

       -->
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
